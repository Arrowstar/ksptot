function [dF,dg] = g2barFox( x )% Gradients for Fox's two-bar truss. % Fox 1971, "Optimization Methods for Engineering Design," p. 12, 130-1.d = x(1);H = x(2);t = 0.1;B = 30.;P = 33.e3;E = 30.e6;Y = 100.e3;rad = sqrt(B^2+H^2);dF(1,1) = 2*pi*t*rad;dF(2,1) = 2*pi*t*d*H/rad;stress = P/(pi*t) * rad/(H*d); % Axial stressdg(1,1) = -stress/d/Y;dg(2,1) = P/(pi*t)/Y*( 1/d/rad - rad/(H^2*d) );dg(1,2) = dg(1,1)*Y/E - pi^2/4*d/(B^2+H^2);dg(2,2) = dg(2,1)*Y/E + pi^2/4*(d^2+t^2)/(B^2+H^2)^2*H;if ~isempty(get(0,'CurrentFigure'))   subplot(1,2,1)   plot(x(1),x(2),'ro','Erasemode','none')   drawnow; % Draws current graph now      subplot(1,2,2)   plot(x(1),x(2),'ro','Erasemode','none')   drawnow; % Draws current graph nowendend