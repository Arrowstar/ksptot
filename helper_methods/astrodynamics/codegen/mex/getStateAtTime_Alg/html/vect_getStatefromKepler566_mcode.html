<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="148,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type0" id="S2T0U3">rVect</span>,<span class="var type0" id="S3T0U4">vVect</span>]=vect_getStatefromKepler(<span class="var type1" id="S4T1U7">sma</span>, <span class="var type1" id="S5T1U8">ecc</span>, <span class="var type1" id="S6T1U9">inc</span>, <span class="var type1" id="S7T1U10">raan</span>, <span class="var type1" id="S8T1U11">arg</span>, <span class="var type1" id="S9T1U12">tru</span>, <span class="var type1" id="S10T2U13">gmu</span>, <span class="var type1" id="S11T10U14">varargin</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="148,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% getStatefromKepler() takes a set of Keplerian orbital elements and turns</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% them into a set of state vectors (position and velocity vectors).</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="148,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% INPUTS</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% sma - semi-major axis of the orbit.  Units: [km]</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% ecc - eccentricity of the orbit.  Units: dimensionless</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% inc - inclination angle of the orbit.  Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% longAscNode - Longitude of ascending node of the orbit.  Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% ArgPeri - Argument of periapse of the orbit.  Units: radian.</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% TrueAnom - Current true anomaly of the spacecraft/body in the orbit.</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">% Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% muCB - the gravitational parameter of the central body.  Units: km^3/s^2</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% ALL ANGLES EXPECTED BETWEEN 0 - 2*pi!  DO NOT USE NEGATIVE ANGLES!</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="148,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% OUTPUTS</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% rVect - a 3x1 vector that contains the x,y,z components of the orbiting</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% body's current position relative to the central body.  Units: [km]</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% vVect - a 3x1 vector that contains the x,y,z components of the orbiting</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% body's current velocity vector relative to the central body.  Units:</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% [km/sec]</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,22" id="srcline22"> 22</a></span><span class="line"><span class="keyword">if</span>(~isempty(<span class="var type1" id="S11T10U21">varargin</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,23" id="srcline23"> 23</a></span><span class="line">    <span class="var type0" id="S13T0U24">consistencyCheck</span> = <span class="var type1" id="S11T10U26">varargin</span>{1};</span></span>
<span class="srcline"><span class="lineno"><a href="148,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,25" id="srcline25"> 25</a></span><span class="line">    <span class="var type0" id="S13T0U31">consistencyCheck</span> = true;</span></span>
<span class="srcline"><span class="lineno"><a href="148,26" id="srcline26"> 26</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="148,28" id="srcline28"> 28</a></span><span class="line"><span class="message fatal" id="M2F566C">[<span class="var type0" id="S2T0U37">rVect</span>, <span class="var type0" id="S3T0U38">vVect</span>] = <span class="fcn" id="F567N26:B40">vect_getStatefromKepler_Alg</span>(<span class="var type1" id="S4T1U41">sma</span>, <span class="var type1" id="S5T1U42">ecc</span>, <span class="var type1" id="S6T1U43">inc</span>, <span class="var type1" id="S7T1U44">raan</span>, <span class="var type1" id="S8T1U45">arg</span>, <span class="var type1" id="S9T1U46">tru</span>, <span class="var type1" id="S10T2U47">gmu</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="148,30" id="srcline30"> 30</a></span><span class="line"><span class="var type0" id="S16T0U50">tol</span> = 1E-6;</span></span>
<span class="srcline"><span class="lineno"><a href="148,31" id="srcline31"> 31</a></span><span class="line"><span class="keyword">if</span>(<span class="var type0" id="S13T0U55">consistencyCheck</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="148,32" id="srcline32"> 32</a></span><span class="line">    [<span class="var type0" id="S4T0U59">sma</span>, <span class="var type0" id="S5T0U60">ecc</span>, <span class="var type0" id="S6T0U61">inc</span>, <span class="var type0" id="S7T0U62">raan</span>, <span class="var type0" id="S8T0U63">arg</span>, <span class="var type0" id="S9T0U64">tru</span>] = vect_getKeplerFromState(<span class="var type0" id="S2T0U67">rVect</span>,<span class="var type0" id="S3T0U68">vVect</span>,<span class="var type0" id="S10T0U69">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,33" id="srcline33"> 33</a></span><span class="line">    [<span class="var type0" id="S19T0U75">rVect2</span>,~]=vect_getStatefromKepler(<span class="var type0" id="S4T0U79">sma</span>, <span class="var type0" id="S5T0U80">ecc</span>, <span class="var type0" id="S6T0U81">inc</span>, <span class="var type0" id="S7T0U82">raan</span>, <span class="var type0" id="S8T0U83">arg</span>, <span class="var type0" id="S9T0U84">tru</span>, <span class="var type0" id="S10T0U85">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,34" id="srcline34"> 34</a></span><span class="line">    <span class="var type0" id="S21T0U90">rDang</span> = real(acos(dot(<span class="var type0" id="S2T0U98">rVect</span>,<span class="var type0" id="S19T0U99">rVect2</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U109">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S19T0U119">rVect2</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,35" id="srcline35"> 35</a></span><span class="line">    <span class="keyword">if</span>(all(<span class="var type0" id="S21T0U128">rDang</span> &lt; <span class="var type0" id="S16T0U129">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,36" id="srcline36"> 36</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,37" id="srcline37"> 37</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="148,39" id="srcline39"> 39</a></span><span class="line">    [<span class="var type0" id="S29T0U134">rVect3</span>,<span class="var type0" id="S30T0U135">vVect3</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U138">sma</span>, <span class="var type0" id="S5T0U139">ecc</span>, <span class="var type0" id="S6T0U140">inc</span>, <span class="var type0" id="S7T0U142">raan</span>-<span class="var type0" id="S21T0U143">rDang</span>, <span class="var type0" id="S8T0U145">arg</span>+<span class="var type0" id="S21T0U146">rDang</span>, <span class="var type0" id="S9T0U147">tru</span>, <span class="var type0" id="S10T0U148">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,40" id="srcline40"> 40</a></span><span class="line">    <span class="var type0" id="S31T0U153">rDang2</span> = real(acos(dot(<span class="var type0" id="S2T0U161">rVect</span>,<span class="var type0" id="S29T0U162">rVect3</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U172">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S29T0U182">rVect3</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,41" id="srcline41"> 41</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S31T0U191">rDang2</span> &lt; <span class="var type0" id="S16T0U192">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,42" id="srcline42"> 42</a></span><span class="line">        <span class="var type0" id="S2T0U196">rVect</span>(:,<span class="var type0" id="S31T0U199">rDang2</span> &lt; <span class="var type0" id="S16T0U200">tol</span>) = <span class="var type0" id="S29T0U202">rVect3</span>(:,<span class="var type0" id="S31T0U205">rDang2</span> &lt; <span class="var type0" id="S16T0U206">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,43" id="srcline43"> 43</a></span><span class="line">        <span class="var type0" id="S3T0U210">vVect</span>(:,<span class="var type0" id="S31T0U213">rDang2</span> &lt; <span class="var type0" id="S16T0U214">tol</span>) = <span class="var type0" id="S30T0U216">vVect3</span>(:,<span class="var type0" id="S31T0U219">rDang2</span> &lt; <span class="var type0" id="S16T0U220">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,44" id="srcline44"> 44</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,45" id="srcline45"> 45</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S31T0U227">rDang2</span> &lt; <span class="var type0" id="S16T0U228">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,46" id="srcline46"> 46</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,47" id="srcline47"> 47</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,48" id="srcline48"> 48</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,49" id="srcline49"> 49</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="148,50" id="srcline50"> 50</a></span><span class="line">    [<span class="var type0" id="S33T0U233">rVect4</span>,<span class="var type0" id="S34T0U234">vVect4</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U237">sma</span>, <span class="var type0" id="S5T0U238">ecc</span>, <span class="var type0" id="S6T0U239">inc</span>, <span class="var type0" id="S7T0U241">raan</span>+<span class="var type0" id="S21T0U242">rDang</span>, <span class="var type0" id="S8T0U244">arg</span>-<span class="var type0" id="S21T0U245">rDang</span>, <span class="var type0" id="S9T0U246">tru</span>, <span class="var type0" id="S10T0U247">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,51" id="srcline51"> 51</a></span><span class="line">    <span class="var type0" id="S35T0U252">rDang3</span> = real(acos(dot(<span class="var type0" id="S2T0U260">rVect</span>,<span class="var type0" id="S33T0U261">rVect4</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U271">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S33T0U281">rVect4</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,52" id="srcline52"> 52</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S35T0U290">rDang3</span> &lt; <span class="var type0" id="S16T0U291">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,53" id="srcline53"> 53</a></span><span class="line">        <span class="var type0" id="S2T0U295">rVect</span>(:,<span class="var type0" id="S35T0U298">rDang3</span> &lt; <span class="var type0" id="S16T0U299">tol</span>) = <span class="var type0" id="S33T0U301">rVect4</span>(:,<span class="var type0" id="S35T0U304">rDang3</span> &lt; <span class="var type0" id="S16T0U305">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,54" id="srcline54"> 54</a></span><span class="line">        <span class="var type0" id="S3T0U309">vVect</span>(:,<span class="var type0" id="S35T0U312">rDang3</span> &lt; <span class="var type0" id="S16T0U313">tol</span>) = <span class="var type0" id="S34T0U315">vVect4</span>(:,<span class="var type0" id="S35T0U318">rDang3</span> &lt; <span class="var type0" id="S16T0U319">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,55" id="srcline55"> 55</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,56" id="srcline56"> 56</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S35T0U326">rDang3</span> &lt; <span class="var type0" id="S16T0U327">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,57" id="srcline57"> 57</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,58" id="srcline58"> 58</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,59" id="srcline59"> 59</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="148,61" id="srcline61"> 61</a></span><span class="line">    [<span class="var type0" id="S36T0U332">rVect5</span>,<span class="var type0" id="S37T0U333">vVect5</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U336">sma</span>, <span class="var type0" id="S5T0U337">ecc</span>, <span class="var type0" id="S6T0U338">inc</span>, <span class="var type0" id="S7T0U340">raan</span>+<span class="var type0" id="S21T0U341">rDang</span>, <span class="var type0" id="S8T0U343">arg</span>+<span class="var type0" id="S21T0U344">rDang</span>, <span class="var type0" id="S9T0U345">tru</span>, <span class="var type0" id="S10T0U346">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,62" id="srcline62"> 62</a></span><span class="line">    <span class="var type0" id="S38T0U351">rDang4</span> = real(acos(dot(<span class="var type0" id="S2T0U359">rVect</span>,<span class="var type0" id="S36T0U360">rVect5</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U370">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S36T0U380">rVect5</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,63" id="srcline63"> 63</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S38T0U389">rDang4</span> &lt; <span class="var type0" id="S16T0U390">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,64" id="srcline64"> 64</a></span><span class="line">        <span class="var type0" id="S2T0U394">rVect</span>(:,<span class="var type0" id="S38T0U397">rDang4</span> &lt; <span class="var type0" id="S16T0U398">tol</span>) = <span class="var type0" id="S36T0U400">rVect5</span>(:,<span class="var type0" id="S38T0U403">rDang4</span> &lt; <span class="var type0" id="S16T0U404">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,65" id="srcline65"> 65</a></span><span class="line">        <span class="var type0" id="S3T0U408">vVect</span>(:,<span class="var type0" id="S38T0U411">rDang4</span> &lt; <span class="var type0" id="S16T0U412">tol</span>) = <span class="var type0" id="S37T0U414">vVect5</span>(:,<span class="var type0" id="S38T0U417">rDang4</span> &lt; <span class="var type0" id="S16T0U418">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,66" id="srcline66"> 66</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,67" id="srcline67"> 67</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S38T0U425">rDang4</span> &lt; <span class="var type0" id="S16T0U426">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,68" id="srcline68"> 68</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,69" id="srcline69"> 69</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,70" id="srcline70"> 70</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="148,72" id="srcline72"> 72</a></span><span class="line">    [<span class="var type0" id="S39T0U431">rVect6</span>,<span class="var type0" id="S40T0U432">vVect6</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U435">sma</span>, <span class="var type0" id="S5T0U436">ecc</span>, <span class="var type0" id="S6T0U437">inc</span>, <span class="var type0" id="S7T0U439">raan</span>-<span class="var type0" id="S21T0U440">rDang</span>, <span class="var type0" id="S8T0U442">arg</span>-<span class="var type0" id="S21T0U443">rDang</span>, <span class="var type0" id="S9T0U444">tru</span>, <span class="var type0" id="S10T0U445">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,73" id="srcline73"> 73</a></span><span class="line">    <span class="var type0" id="S41T0U450">rDang5</span> = real(acos(dot(<span class="var type0" id="S2T0U458">rVect</span>,<span class="var type0" id="S39T0U459">rVect6</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U469">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S39T0U479">rVect6</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,74" id="srcline74"> 74</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S41T0U488">rDang5</span> &lt; <span class="var type0" id="S16T0U489">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,75" id="srcline75"> 75</a></span><span class="line">        <span class="var type0" id="S2T0U493">rVect</span>(:,<span class="var type0" id="S41T0U496">rDang5</span> &lt; <span class="var type0" id="S16T0U497">tol</span>) = <span class="var type0" id="S39T0U499">rVect6</span>(:,<span class="var type0" id="S41T0U502">rDang5</span> &lt; <span class="var type0" id="S16T0U503">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,76" id="srcline76"> 76</a></span><span class="line">        <span class="var type0" id="S3T0U507">vVect</span>(:,<span class="var type0" id="S41T0U510">rDang5</span> &lt; <span class="var type0" id="S16T0U511">tol</span>) = <span class="var type0" id="S40T0U513">vVect6</span>(:,<span class="var type0" id="S41T0U516">rDang5</span> &lt; <span class="var type0" id="S16T0U517">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,77" id="srcline77"> 77</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,78" id="srcline78"> 78</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S41T0U524">rDang5</span> &lt; <span class="var type0" id="S16T0U525">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,79" id="srcline79"> 79</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,80" id="srcline80"> 80</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,82" id="srcline82"> 82</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="148,83" id="srcline83"> 83</a></span><span class="line">    [<span class="var type0" id="S42T0U530">rVect7</span>,<span class="var type0" id="S43T0U531">vVect7</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U534">sma</span>, <span class="var type0" id="S5T0U535">ecc</span>, <span class="var type0" id="S6T0U536">inc</span>, <span class="var type0" id="S7T0U537">raan</span>, <span class="var type0" id="S8T0U538">arg</span>, <span class="var type0" id="S9T0U540">tru</span>-<span class="var type0" id="S21T0U541">rDang</span>, <span class="var type0" id="S10T0U542">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,84" id="srcline84"> 84</a></span><span class="line">    <span class="var type0" id="S44T0U547">rDang6</span> = real(acos(dot(<span class="var type0" id="S2T0U555">rVect</span>,<span class="var type0" id="S42T0U556">rVect7</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U566">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S42T0U576">rVect7</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,85" id="srcline85"> 85</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S44T0U585">rDang6</span> &lt; <span class="var type0" id="S16T0U586">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,86" id="srcline86"> 86</a></span><span class="line">        <span class="var type0" id="S2T0U590">rVect</span>(:,<span class="var type0" id="S44T0U593">rDang6</span> &lt; <span class="var type0" id="S16T0U594">tol</span>) = <span class="var type0" id="S42T0U596">rVect7</span>(:,<span class="var type0" id="S44T0U599">rDang6</span> &lt; <span class="var type0" id="S16T0U600">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,87" id="srcline87"> 87</a></span><span class="line">        <span class="var type0" id="S3T0U604">vVect</span>(:,<span class="var type0" id="S44T0U607">rDang6</span> &lt; <span class="var type0" id="S16T0U608">tol</span>) = <span class="var type0" id="S43T0U610">vVect7</span>(:,<span class="var type0" id="S44T0U613">rDang6</span> &lt; <span class="var type0" id="S16T0U614">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,88" id="srcline88"> 88</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,89" id="srcline89"> 89</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S44T0U621">rDang6</span> &lt; <span class="var type0" id="S16T0U622">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,90" id="srcline90"> 90</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,91" id="srcline91"> 91</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,92" id="srcline92"> 92</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,93" id="srcline93"> 93</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="148,94" id="srcline94"> 94</a></span><span class="line">    [<span class="var type0" id="S45T0U627">rVect8</span>,<span class="var type0" id="S46T0U628">vVect8</span>]=vect_getStatefromKepler(<span class="var type0" id="S4T0U631">sma</span>, <span class="var type0" id="S5T0U632">ecc</span>, <span class="var type0" id="S6T0U633">inc</span>, <span class="var type0" id="S7T0U634">raan</span>, <span class="var type0" id="S8T0U635">arg</span>, <span class="var type0" id="S9T0U637">tru</span>+<span class="var type0" id="S21T0U638">rDang</span>, <span class="var type0" id="S10T0U639">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="148,95" id="srcline95"> 95</a></span><span class="line">    <span class="var type0" id="S47T0U644">rDang7</span> = real(acos(dot(<span class="var type0" id="S2T0U652">rVect</span>,<span class="var type0" id="S45T0U653">rVect8</span>)./(sqrt(sum(abs(<span class="var type0" id="S2T0U663">rVect</span>).^2,1)) .* sqrt(sum(abs(<span class="var type0" id="S45T0U673">rVect8</span>).^2,1)) )));</span></span>
<span class="srcline"><span class="lineno"><a href="148,96" id="srcline96"> 96</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type0" id="S47T0U682">rDang7</span> &lt; <span class="var type0" id="S16T0U683">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,97" id="srcline97"> 97</a></span><span class="line">        <span class="var type0" id="S2T0U687">rVect</span>(:,<span class="var type0" id="S47T0U690">rDang7</span> &lt; <span class="var type0" id="S16T0U691">tol</span>) = <span class="var type0" id="S45T0U693">rVect8</span>(:,<span class="var type0" id="S47T0U696">rDang7</span> &lt; <span class="var type0" id="S16T0U697">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,98" id="srcline98"> 98</a></span><span class="line">        <span class="var type0" id="S3T0U701">vVect</span>(:,<span class="var type0" id="S47T0U704">rDang7</span> &lt; <span class="var type0" id="S16T0U705">tol</span>) = <span class="var type0" id="S46T0U707">vVect8</span>(:,<span class="var type0" id="S47T0U710">rDang7</span> &lt; <span class="var type0" id="S16T0U711">tol</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="148,99" id="srcline99"> 99</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="148,100" id="srcline100">100</a></span><span class="line">        <span class="keyword">if</span>(all(<span class="var type0" id="S47T0U718">rDang7</span> &lt; <span class="var type0" id="S16T0U719">tol</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="148,101" id="srcline101">101</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="148,102" id="srcline102">102</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,103" id="srcline103">103</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="148,104" id="srcline104">104</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="148,105" id="srcline105">105</a></span><span class="line"></span></span>
</pre>
</body>
</html>
