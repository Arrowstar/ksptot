<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="149,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type0" id="S2T0U3">rVect</span>, <span class="var type0" id="S3T0U4">vVect</span>] = vect_getStatefromKepler_Alg(<span class="var type1" id="S4T1U7">sma</span>, <span class="var type1" id="S5T1U8">ecc</span>, <span class="var type1" id="S6T1U9">inc</span>, <span class="var type1" id="S7T1U10">raan</span>, <span class="var type1" id="S8T1U11">arg</span>, <span class="var type1" id="S9T1U12">tru</span>, <span class="var type1" id="S10T2U13">gmu</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="149,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%getStatefromKepler_Alg Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,4" id="srcline4"> 4</a></span><span class="line">    <span class="var type1" id="S11T2U16">numOrb</span> = length(<span class="var type1" id="S9T1U19">tru</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,6" id="srcline6"> 6</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,7" id="srcline7"> 7</a></span><span class="line">    <span class="comment">% Special Case: Circular Equitorial</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,8" id="srcline8"> 8</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,9" id="srcline9"> 9</a></span><span class="line">    <span class="var type1" id="S13T28U22">bool</span> = <span class="var type1" id="S5T1U25">ecc</span> &lt; 1E-10 &amp; (<span class="var type1" id="S6T1U30">inc</span> &lt; 1E-10 | abs(<span class="var type1" id="S6T1U36">inc</span>-pi) &lt; 1E-10);</span></span>
<span class="srcline"><span class="lineno"><a href="149,10" id="srcline10">10</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type1" id="S13T28U45">bool</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="149,11" id="srcline11">11</a></span><span class="line">        <span class="var type1" id="S17T1U48">l</span> = zeros(size(<span class="var type1" id="S13T28U53">bool</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="149,12" id="srcline12">12</a></span><span class="line">        <span class="var type1" id="S17T1U57">l</span>(<span class="var type1" id="S13T28U58">bool</span>) = <span class="var type1" id="S7T1U62">raan</span>(<span class="var type1" id="S13T28U63">bool</span>) + <span class="var type1" id="S8T1U65">arg</span>(<span class="var type1" id="S13T28U66">bool</span>) + <span class="var type1" id="S9T1U68">tru</span>(<span class="var type1" id="S13T28U69">bool</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,13" id="srcline13">13</a></span><span class="line">        <span class="var type1" id="S9T1U73">tru</span>(<span class="var type1" id="S13T28U74">bool</span>) = <span class="var type1" id="S17T1U76">l</span>(<span class="var type1" id="S13T28U77">bool</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,14" id="srcline14">14</a></span><span class="line">        <span class="var type1" id="S7T1U81">raan</span>(<span class="var type1" id="S13T28U82">bool</span>) = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="149,15" id="srcline15">15</a></span><span class="line">        <span class="var type1" id="S8T1U87">arg</span>(<span class="var type1" id="S13T28U88">bool</span>) = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="149,16" id="srcline16">16</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,18" id="srcline18">18</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,19" id="srcline19">19</a></span><span class="line">    <span class="comment">% Special Case: Circular Inclined</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,20" id="srcline20">20</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,21" id="srcline21">21</a></span><span class="line">    <span class="var type1" id="S13T28U92">bool</span> = <span class="var type1" id="S5T1U96">ecc</span> &lt; 1E-10 &amp; <span class="var type1" id="S6T1U99">inc</span> &gt;= 1E-10 &amp; abs(<span class="var type1" id="S6T1U105">inc</span>-pi) &gt;= 1E-10;</span></span>
<span class="srcline"><span class="lineno"><a href="149,22" id="srcline22">22</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type1" id="S13T28U114">bool</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="149,23" id="srcline23">23</a></span><span class="line">        <span class="var type1" id="S20T1U117">u</span> = nan(size(<span class="var type1" id="S5T1U122">ecc</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="149,24" id="srcline24">24</a></span><span class="line">        <span class="var type1" id="S20T1U126">u</span>(<span class="var type1" id="S13T28U127">bool</span>) = <span class="var type1" id="S8T1U130">arg</span>(<span class="var type1" id="S13T28U131">bool</span>) + <span class="var type1" id="S9T1U133">tru</span>(<span class="var type1" id="S13T28U134">bool</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,25" id="srcline25">25</a></span><span class="line">        <span class="var type1" id="S9T1U138">tru</span>(<span class="var type1" id="S13T28U139">bool</span>) = <span class="var type1" id="S20T1U141">u</span>(<span class="var type1" id="S13T28U142">bool</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,26" id="srcline26">26</a></span><span class="line">        <span class="var type1" id="S8T1U146">arg</span>(<span class="var type1" id="S13T28U147">bool</span>) = 0.0; <span class="comment">%may need to remove this, new addition</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,27" id="srcline27">27</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,29" id="srcline29">29</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,30" id="srcline30">30</a></span><span class="line">    <span class="comment">% Special Case: Elliptical Equitorial</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,31" id="srcline31">31</a></span><span class="line">    <span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,32" id="srcline32">32</a></span><span class="line">    <span class="var type1" id="S13T28U151">bool</span> = <span class="var type1" id="S5T1U154">ecc</span> &gt;= 1E-10 &amp; (<span class="var type1" id="S6T1U159">inc</span> &lt; 1E-10 | abs(<span class="var type1" id="S6T1U165">inc</span>-pi) &lt; 1E-10);</span></span>
<span class="srcline"><span class="lineno"><a href="149,33" id="srcline33">33</a></span><span class="line">    <span class="keyword">if</span>(any(<span class="var type1" id="S13T28U174">bool</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="149,34" id="srcline34">34</a></span><span class="line">        <span class="var type1" id="S7T1U178">raan</span>(<span class="var type1" id="S13T28U179">bool</span>) = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="149,35" id="srcline35">35</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,37" id="srcline37">37</a></span><span class="line">    <span class="var type1" id="S22T1U183">p</span> = <span class="var type1" id="S4T1U185">sma</span>.*(1-<span class="var type1" id="S5T1U190">ecc</span>.^2);</span></span>
<span class="srcline"><span class="lineno"><a href="149,38" id="srcline38">38</a></span><span class="line">    <span class="var type1" id="S23T1U194">rPQW</span> = [<span class="var type1" id="S22T1U199">p</span>.*cos(<span class="var type1" id="S9T1U202">tru</span>) ./ (1 + <span class="var type1" id="S5T1U207">ecc</span>.*cos(<span class="var type1" id="S9T1U210">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="149,39" id="srcline39">39</a></span><span class="line">            <span class="var type1" id="S22T1U214">p</span>.*sin(<span class="var type1" id="S9T1U217">tru</span>) ./ (1 + <span class="var type1" id="S5T1U222">ecc</span>.*cos(<span class="var type1" id="S9T1U225">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="149,40" id="srcline40">40</a></span><span class="line">            zeros(<span class="mxinfo " id="T2:U71">1</span>,length(<span class="var type1" id="S9T1U232">tru</span>))];</span></span>
<span class="srcline"><span class="lineno"><a href="149,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,42" id="srcline42">42</a></span><span class="line">    <span class="var type1" id="S26T1U235">vPQW</span> = [-sqrt(<span class="var type1" id="S10T2U243">gmu</span>./<span class="var type1" id="S22T1U244">p</span>).*sin(<span class="var type1" id="S9T1U247">tru</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,43" id="srcline43">43</a></span><span class="line">            sqrt(<span class="var type1" id="S10T2U253">gmu</span>./<span class="var type1" id="S22T1U254">p</span>).*(<span class="var type1" id="S5T1U257">ecc</span> + cos(<span class="var type1" id="S9T1U260">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="149,44" id="srcline44">44</a></span><span class="line">            zeros(<span class="mxinfo " id="T2:U81">1</span>,length(<span class="var type1" id="S9T1U267">tru</span>))];</span></span>
<span class="srcline"><span class="lineno"><a href="149,45" id="srcline45">45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,46" id="srcline46">46</a></span><span class="line">    <span class="var type1" id="S28T73U270">TransMatrix</span> = [reshape(cos(<span class="var type1" id="S7T1U279">raan</span>).*cos(<span class="var type1" id="S8T1U282">arg</span>)-sin(<span class="var type1" id="S7T1U287">raan</span>).*sin(<span class="var type1" id="S8T1U290">arg</span>).*cos(<span class="var type1" id="S6T1U293">inc</span>),1,1,<span class="var type1" id="S11T2U296">numOrb</span>), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,47" id="srcline47">47</a></span><span class="line">                   reshape(-cos(<span class="var type1" id="S7T1U304">raan</span>).*sin(<span class="var type1" id="S8T1U307">arg</span>)-sin(<span class="var type1" id="S7T1U312">raan</span>).*cos(<span class="var type1" id="S8T1U315">arg</span>).*cos(<span class="var type1" id="S6T1U318">inc</span>),1,1,<span class="var type1" id="S11T2U321">numOrb</span>), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,48" id="srcline48">48</a></span><span class="line">                   reshape(sin(<span class="var type1" id="S7T1U327">raan</span>).*sin(<span class="var type1" id="S6T1U330">inc</span>),1,1,<span class="var type1" id="S11T2U333">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,49" id="srcline49">49</a></span><span class="line">                   reshape(sin(<span class="var type1" id="S7T1U341">raan</span>).*cos(<span class="var type1" id="S8T1U344">arg</span>)+cos(<span class="var type1" id="S7T1U349">raan</span>).*sin(<span class="var type1" id="S8T1U352">arg</span>).*cos(<span class="var type1" id="S6T1U355">inc</span>),1,1,<span class="var type1" id="S11T2U358">numOrb</span>), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,50" id="srcline50">50</a></span><span class="line">                   reshape(-sin(<span class="var type1" id="S7T1U366">raan</span>).*sin(<span class="var type1" id="S8T1U369">arg</span>)+cos(<span class="var type1" id="S7T1U374">raan</span>).*cos(<span class="var type1" id="S8T1U377">arg</span>).*cos(<span class="var type1" id="S6T1U380">inc</span>),1,1,<span class="var type1" id="S11T2U383">numOrb</span>), <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,51" id="srcline51">51</a></span><span class="line">                   reshape(-cos(<span class="var type1" id="S7T1U390">raan</span>).*sin(<span class="var type1" id="S6T1U393">inc</span>),1,1,<span class="var type1" id="S11T2U396">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,52" id="srcline52">52</a></span><span class="line">                   reshape(sin(<span class="var type1" id="S8T1U403">arg</span>).*sin(<span class="var type1" id="S6T1U406">inc</span>),1,1,<span class="var type1" id="S11T2U409">numOrb</span>),<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,53" id="srcline53">53</a></span><span class="line">                   reshape(cos(<span class="var type1" id="S8T1U415">arg</span>).*sin(<span class="var type1" id="S6T1U418">inc</span>),1,1,<span class="var type1" id="S11T2U421">numOrb</span>),<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,54" id="srcline54">54</a></span><span class="line">                   reshape(cos(<span class="var type1" id="S6T1U426">inc</span>),1,1,<span class="var type1" id="S11T2U429">numOrb</span>)];</span></span>
<span class="srcline"><span class="lineno"><a href="149,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,56" id="srcline56">56</a></span><span class="line"><span class="comment">%     TransMatrix = reshape(TransMatrix,3,3,numOrb);</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,57" id="srcline57">57</a></span><span class="line">    <span class="var type1" id="S23T74U432">rPQW</span> = reshape(<span class="var type1" id="S23T1U435">rPQW</span>, 3,1,<span class="var type1" id="S11T2U438">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,58" id="srcline58">58</a></span><span class="line">    <span class="var type0" id="S26T0U441">vPQW</span> = reshape(<span class="var type1" id="S26T1U444">vPQW</span>, 3,1,<span class="var type1" id="S11T2U447">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,59" id="srcline59">59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="149,60" id="srcline60">60</a></span><span class="line">    <span class="var type0" id="S2T0U450">rVect</span> = <span class="message fatal" id="M3F567C"><span class="fcn" id="F678N17:B452">multiprod</span>(<span class="var type1" id="S28T73U453">TransMatrix</span>, <span class="var type1" id="S23T74U454">rPQW</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="149,61" id="srcline61">61</a></span><span class="line">    <span class="var type0" id="S3T0U457">vVect</span> = multiprod(<span class="var type0" id="S28T0U460">TransMatrix</span>, <span class="var type0" id="S26T0U461">vPQW</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,62" id="srcline62">62</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="149,63" id="srcline63">63</a></span><span class="line">    <span class="var type0" id="S2T0U464">rVect</span> = reshape(<span class="var type0" id="S2T0U467">rVect</span>, 3,<span class="var type0" id="S11T0U469">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,64" id="srcline64">64</a></span><span class="line">    <span class="var type0" id="S3T0U472">vVect</span> = reshape(<span class="var type0" id="S3T0U475">vVect</span>, 3,<span class="var type0" id="S11T0U477">numOrb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="149,65" id="srcline65">65</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="149,66" id="srcline66">66</a></span><span class="line"></span></span>
</pre>
</body>
</html>
