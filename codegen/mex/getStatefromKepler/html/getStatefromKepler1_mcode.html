<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T9U3">rVect</span>,<span class="var type1" id="S3T9U4">vVect</span>]=getStatefromKepler(<span class="var type1" id="S4T2U7">sma</span>, <span class="var type1" id="S5T2U8">ecc</span>, <span class="var type1" id="S6T2U9">inc</span>, <span class="var type1" id="S7T2U10">raan</span>, <span class="var type1" id="S8T2U11">arg</span>, <span class="var type1" id="S9T2U12">tru</span>, <span class="var type1" id="S10T2U13">gmu</span>, <span class="var type1" id="S11T1U14">varargin</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% getStatefromKepler() takes a set of Keplerian orbital elements and turns</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% them into a set of state vectors (position and velocity vectors).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% INPUTS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% sma - semi-major axis of the orbit.  Units: [km]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% ecc - eccentricity of the orbit.  Units: dimensionless</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% inc - inclination angle of the orbit.  Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% longAscNode - Longitude of ascending node of the orbit.  Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% ArgPeri - Argument of periapse of the orbit.  Units: radian.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% TrueAnom - Current true anomaly of the spacecraft/body in the orbit.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">% Units: radian</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% muCB - the gravitational parameter of the central body.  Units: km^3/s^2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% ALL ANGLES EXPECTED BETWEEN 0 - 2*pi!  DO NOT USE NEGATIVE ANGLES!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% OUTPUTS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% rVect - a 3x1 vector that contains the x,y,z components of the orbiting</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% body's current position relative to the central body.  Units: [km]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% vVect - a 3x1 vector that contains the x,y,z components of the orbiting</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% body's current velocity vector relative to the central body.  Units:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% [km/sec]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="keyword">if</span>(~isempty(<span class="var type1" id="S11T1U21">varargin</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">    <span class="var type2" id="S13T0U24">consistencyCheck</span> = <span class="var type2" id="S11T0U26">varargin</span>{1};</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">    <span class="var type1" id="S13T5U31">consistencyCheck</span> = true;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% Special Case: Circular Equitorial</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="keyword">if</span>(<span class="var type1" id="S5T2U39">ecc</span> &lt; 1E-10 &amp;&amp; (<span class="var type1" id="S6T2U44">inc</span> &lt; 1E-10 || abs(<span class="var type1" id="S6T2U50">inc</span>-pi) &lt; 1E-10))</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="var type1" id="S17T2U56">l</span> = <span class="var type1" id="S7T2U59">raan</span> + <span class="var type1" id="S8T2U60">arg</span> + <span class="var type1" id="S9T2U61">tru</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="var type1" id="S9T2U64">tru</span> = <span class="var type1" id="S17T2U65">l</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="var type1" id="S7T2U68">raan</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="var type1" id="S8T2U72">arg</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">% Special Case: Circular Inclined</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="keyword">if</span>(<span class="var type1" id="S5T2U80">ecc</span> &lt; 1E-10 &amp;&amp; <span class="var type1" id="S6T2U83">inc</span> &gt;= 1E-10 &amp;&amp; abs(<span class="var type1" id="S6T2U89">inc</span>-pi) &gt;= 1E-10)</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="var type1" id="S18T2U95">u</span> = <span class="var type1" id="S8T2U97">arg</span> + <span class="var type1" id="S9T2U98">tru</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="var type1" id="S9T2U101">tru</span> = <span class="var type1" id="S18T2U102">u</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">% Special Case: Elliptical Equitorial</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">if</span>(<span class="var type1" id="S5T2U108">ecc</span> &gt;= 1E-10 &amp;&amp; (<span class="var type1" id="S6T2U113">inc</span> &lt; 1E-10 || abs(<span class="var type1" id="S6T2U119">inc</span>-pi) &lt; 1E-10))</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="var type1" id="S7T2U125">raan</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="var type1" id="S19T2U129">p</span> = <span class="var type1" id="S4T2U131">sma</span>*(1-<span class="var type1" id="S5T2U136">ecc</span>^2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="var type1" id="S20T9U140">rPQW</span> = [<span class="var type1" id="S19T2U145">p</span>*cos(<span class="var type1" id="S9T2U148">tru</span>) / (1 + <span class="var type1" id="S5T2U153">ecc</span>*cos(<span class="var type1" id="S9T2U156">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">        <span class="var type1" id="S19T2U160">p</span>*sin(<span class="var type1" id="S9T2U163">tru</span>) / (1 + <span class="var type1" id="S5T2U168">ecc</span>*cos(<span class="var type1" id="S9T2U171">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">        0];</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="var type1" id="S23T9U176">vPQW</span> = [-sqrt(<span class="var type1" id="S10T2U184">gmu</span>/<span class="var type1" id="S19T2U185">p</span>)*sin(<span class="var type1" id="S9T2U188">tru</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">        sqrt(<span class="var type1" id="S10T2U194">gmu</span>/<span class="var type1" id="S19T2U195">p</span>)*(<span class="var type1" id="S5T2U198">ecc</span> + cos(<span class="var type1" id="S9T2U201">tru</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">        0];</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="var type1" id="S25T8U206">TransMatrix</span> = [cos(<span class="var type1" id="S7T2U213">raan</span>)*cos(<span class="var type1" id="S8T2U216">arg</span>)-sin(<span class="var type1" id="S7T2U221">raan</span>)*sin(<span class="var type1" id="S8T2U224">arg</span>)*cos(<span class="var type1" id="S6T2U227">inc</span>), -cos(<span class="var type1" id="S7T2U233">raan</span>)*sin(<span class="var type1" id="S8T2U236">arg</span>)-sin(<span class="var type1" id="S7T2U241">raan</span>)*cos(<span class="var type1" id="S8T2U244">arg</span>)*cos(<span class="var type1" id="S6T2U247">inc</span>), sin(<span class="var type1" id="S7T2U251">raan</span>)*sin(<span class="var type1" id="S6T2U254">inc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">               sin(<span class="var type1" id="S7T2U260">raan</span>)*cos(<span class="var type1" id="S8T2U263">arg</span>)+cos(<span class="var type1" id="S7T2U268">raan</span>)*sin(<span class="var type1" id="S8T2U271">arg</span>)*cos(<span class="var type1" id="S6T2U274">inc</span>), -sin(<span class="var type1" id="S7T2U280">raan</span>)*sin(<span class="var type1" id="S8T2U283">arg</span>)+cos(<span class="var type1" id="S7T2U288">raan</span>)*cos(<span class="var type1" id="S8T2U291">arg</span>)*cos(<span class="var type1" id="S6T2U294">inc</span>), -cos(<span class="var type1" id="S7T2U299">raan</span>)*sin(<span class="var type1" id="S6T2U302">inc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">               sin(<span class="var type1" id="S8T2U307">arg</span>)*sin(<span class="var type1" id="S6T2U310">inc</span>),                              cos(<span class="var type1" id="S8T2U314">arg</span>)*sin(<span class="var type1" id="S6T2U317">inc</span>),                               cos(<span class="var type1" id="S6T2U320">inc</span>)];</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="var type1" id="S2T9U323">rVect</span> = <span class="var type1" id="S25T8U325">TransMatrix</span> * <span class="var type1" id="S20T9U326">rPQW</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="var type1" id="S3T9U329">vVect</span> = <span class="var type1" id="S25T8U331">TransMatrix</span> * <span class="var type1" id="S23T9U332">vPQW</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="keyword">if</span>(<span class="var type1" id="S13T5U336">consistencyCheck</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    [<span class="var type1" id="S4T2U340">sma</span>, <span class="var type1" id="S5T2U341">ecc</span>, <span class="var type1" id="S6T2U342">inc</span>, <span class="var type1" id="S7T2U343">raan</span>, <span class="var type1" id="S8T2U344">arg</span>, <span class="var type1" id="S9T2U345">tru</span>] = <span class="fcn" id="F50N4:B347">getKeplerFromState</span>(<span class="var type1" id="S2T9U348">rVect</span>,<span class="var type1" id="S3T9U349">vVect</span>,<span class="var type1" id="S10T2U350">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">    <span class="message error" id="M1F1C">[<span class="var type0" id="S28T0U356"><span class="message error" id="M2F1C">rVect2</span></span>,<span class="message error" id="M3F1C">~</span>]=getStatefromKepler(<span class="var type1" id="S4T2U360">sma</span>, <span class="var type1" id="S5T2U361">ecc</span>, <span class="var type1" id="S6T2U362">inc</span>, <span class="var type1" id="S7T2U363">raan</span>, <span class="var type1" id="S8T2U364">arg</span>, <span class="var type1" id="S9T2U365">tru</span>, <span class="var type1" id="S10T2U366">gmu</span>, false)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">    <span class="var type0" id="S30T0U371">rDang</span> = real(acos(dot(<span class="var type1" id="S2T9U379">rVect</span>,<span class="var type0" id="S28T0U380"><span class="message error" id="M4F1C">rVect2</span></span>)/(norm(<span class="var type2" id="S2T0U385">rVect</span>) * norm(<span class="var type0" id="S28T0U388">rVect2</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S30T0U393"><span class="message error" id="M5F1C">rDang</span></span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    [<span class="var type0" id="S35T0U399"><span class="message error" id="M7F1C">rVect3</span></span>,<span class="var type0" id="S36T0U400"><span class="message error" id="M8F1C">vVect3</span></span>]=getStatefromKepler(<span class="var type1" id="S4T2U403">sma</span>, <span class="var type1" id="S5T2U404">ecc</span>, <span class="var type1" id="S6T2U405">inc</span>, <span class="var type1" id="S7T2U407">raan</span>-<span class="var type0" id="S30T0U408"><span class="message error" id="M6F1C">rDang</span></span>, <span class="var type2" id="S8T0U410">arg</span>+<span class="var type0" id="S30T0U411">rDang</span>, <span class="var type2" id="S9T0U412">tru</span>, <span class="var type2" id="S10T0U413">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">    <span class="var type0" id="S37T0U418">rDang2</span> = real(acos(dot(<span class="var type1" id="S2T9U426">rVect</span>,<span class="var type0" id="S35T0U427"><span class="message error" id="M9F1C">rVect3</span></span>)/(norm(<span class="var type2" id="S2T0U432">rVect</span>) * norm(<span class="var type0" id="S35T0U435">rVect3</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S37T0U440"><span class="message error" id="M10F1C">rDang2</span></span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="var type2" id="S2T0U444">rVect</span> = <span class="var type0" id="S35T0U445"><span class="message error" id="M11F1C">rVect3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="var type2" id="S3T0U448">vVect</span> = <span class="var type0" id="S36T0U449"><span class="message error" id="M12F1C">vVect3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    [<span class="var type0" id="S38T0U454"><span class="message error" id="M14F1C">rVect4</span></span>,<span class="var type0" id="S39T0U455"><span class="message error" id="M15F1C">vVect4</span></span>]=getStatefromKepler(<span class="var type1" id="S4T2U458">sma</span>, <span class="var type1" id="S5T2U459">ecc</span>, <span class="var type1" id="S6T2U460">inc</span>, <span class="var type1" id="S7T2U462">raan</span>+<span class="var type0" id="S30T0U463"><span class="message error" id="M13F1C">rDang</span></span>, <span class="var type2" id="S8T0U465">arg</span>-<span class="var type0" id="S30T0U466">rDang</span>, <span class="var type2" id="S9T0U467">tru</span>, <span class="var type2" id="S10T0U468">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">    <span class="var type0" id="S40T0U473">rDang3</span> = real(acos(dot(<span class="var type1" id="S2T9U481">rVect</span>,<span class="var type0" id="S38T0U482"><span class="message error" id="M16F1C">rVect4</span></span>)/(norm(<span class="var type2" id="S2T0U487">rVect</span>) * norm(<span class="var type0" id="S38T0U490">rVect4</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S40T0U495"><span class="message error" id="M17F1C">rDang3</span></span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">        <span class="var type2" id="S2T0U499">rVect</span> = <span class="var type0" id="S38T0U500"><span class="message error" id="M18F1C">rVect4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="var type2" id="S3T0U503">vVect</span> = <span class="var type0" id="S39T0U504"><span class="message error" id="M19F1C">vVect4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    [<span class="var type0" id="S41T0U509"><span class="message error" id="M21F1C">rVect5</span></span>,<span class="var type0" id="S42T0U510"><span class="message error" id="M22F1C">vVect5</span></span>]=getStatefromKepler(<span class="var type1" id="S4T2U513">sma</span>, <span class="var type1" id="S5T2U514">ecc</span>, <span class="var type1" id="S6T2U515">inc</span>, <span class="var type1" id="S7T2U517">raan</span>+<span class="var type0" id="S30T0U518"><span class="message error" id="M20F1C">rDang</span></span>, <span class="var type2" id="S8T0U520">arg</span>+<span class="var type0" id="S30T0U521">rDang</span>, <span class="var type2" id="S9T0U522">tru</span>, <span class="var type2" id="S10T0U523">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    <span class="var type0" id="S43T0U528">rDang4</span> = real(acos(dot(<span class="var type1" id="S2T9U536">rVect</span>,<span class="var type0" id="S41T0U537"><span class="message error" id="M23F1C">rVect5</span></span>)/(norm(<span class="var type2" id="S2T0U542">rVect</span>) * norm(<span class="var type0" id="S41T0U545">rVect5</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S43T0U550"><span class="message fatal" id="M24F1C">rDang4</span></span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">        <span class="var type2" id="S2T0U554">rVect</span> = <span class="var type0" id="S41T0U555">rVect5</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">        <span class="var type2" id="S3T0U558">vVect</span> = <span class="var type0" id="S42T0U559">vVect5</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    [<span class="var type0" id="S44T0U564">rVect6</span>,<span class="var type0" id="S45T0U565">vVect6</span>]=getStatefromKepler(<span class="var type2" id="S4T0U568">sma</span>, <span class="var type2" id="S5T0U569">ecc</span>, <span class="var type2" id="S6T0U570">inc</span>, <span class="var type2" id="S7T0U572">raan</span>-<span class="var type0" id="S30T0U573">rDang</span>, <span class="var type2" id="S8T0U575">arg</span>-<span class="var type0" id="S30T0U576">rDang</span>, <span class="var type2" id="S9T0U577">tru</span>, <span class="var type2" id="S10T0U578">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="var type0" id="S46T0U583">rDang5</span> = real(acos(dot(<span class="var type2" id="S2T0U591">rVect</span>,<span class="var type0" id="S44T0U592">rVect6</span>)/(norm(<span class="var type2" id="S2T0U597">rVect</span>) * norm(<span class="var type0" id="S44T0U600">rVect6</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S46T0U605">rDang5</span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">        <span class="var type2" id="S2T0U609">rVect</span> = <span class="var type0" id="S44T0U610">rVect6</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">        <span class="var type2" id="S3T0U613">vVect</span> = <span class="var type0" id="S45T0U614">vVect6</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    [<span class="var type0" id="S47T0U619">rVect7</span>,<span class="var type0" id="S48T0U620">vVect7</span>]=getStatefromKepler(<span class="var type2" id="S4T0U623">sma</span>, <span class="var type2" id="S5T0U624">ecc</span>, <span class="var type2" id="S6T0U625">inc</span>, <span class="var type2" id="S7T0U626">raan</span>, <span class="var type2" id="S8T0U627">arg</span>, <span class="var type2" id="S9T0U629">tru</span>-<span class="var type0" id="S30T0U630">rDang</span>, <span class="var type2" id="S10T0U631">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="var type0" id="S49T0U636">rDang6</span> = real(acos(dot(<span class="var type2" id="S2T0U644">rVect</span>,<span class="var type0" id="S47T0U645">rVect7</span>)/(norm(<span class="var type2" id="S2T0U650">rVect</span>) * norm(<span class="var type0" id="S47T0U653">rVect7</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S49T0U658">rDang6</span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">        <span class="var type2" id="S2T0U662">rVect</span> = <span class="var type0" id="S47T0U663">rVect7</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">        <span class="var type2" id="S3T0U666">vVect</span> = <span class="var type0" id="S48T0U667">vVect7</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    [<span class="var type0" id="S50T0U672">rVect8</span>,<span class="var type0" id="S51T0U673">vVect8</span>]=getStatefromKepler(<span class="var type2" id="S4T0U676">sma</span>, <span class="var type2" id="S5T0U677">ecc</span>, <span class="var type2" id="S6T0U678">inc</span>, <span class="var type2" id="S7T0U679">raan</span>, <span class="var type2" id="S8T0U680">arg</span>, <span class="var type2" id="S9T0U682">tru</span>+<span class="var type0" id="S30T0U683">rDang</span>, <span class="var type2" id="S10T0U684">gmu</span>, false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    <span class="var type0" id="S52T0U689">rDang7</span> = real(acos(dot(<span class="var type2" id="S2T0U697">rVect</span>,<span class="var type0" id="S50T0U698">rVect8</span>)/(norm(<span class="var type2" id="S2T0U703">rVect</span>) * norm(<span class="var type0" id="S50T0U706">rVect8</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">if</span>(<span class="var type0" id="S52T0U711">rDang7</span> &lt; 1E-6)</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="var type2" id="S2T0U715">rVect</span> = <span class="var type0" id="S50T0U716">rVect8</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">        <span class="var type2" id="S3T0U719">vVect</span> = <span class="var type0" id="S51T0U720">vVect8</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"></span></span>
</pre>
